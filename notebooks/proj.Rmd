---
title: "R Notebook"
output:
  pdf_document: default
  html_notebook: default
---

# Paleoecology data stuff

```{r}
require(tidyverse)
setwd('~/Classwork/Current/QB')
df <- readxl::read_excel('Project/species.xlsx')
df_long <- df %>%
  gather(key = 'time', value = 'pres', Bed_1L:Bed_m, factor_key=TRUE)
df_long
```

## Let's draw a time series

```{r}
time_series <- df_long %>%
  group_by(time) %>%
  summarize(time_sums = sum(pres))
time_series
g <- ggplot(time_series, aes(x = time, y = time_sums, group=1)) +
  geom_point() +
  stat_smooth(method = 'lm') +
  xlab('Layer [proxy for time]') +
  ylab('S')
g
```
## How are species distributed in time?

```{r}
time_dist <- df_long %>%
  group_by(Genus) %>%
  mutate(combined_genus = prod(pres)) %>%
  summarize(prop_pres = mean(pres))

time_dist$Genus <- fct_reorder(time_dist$Genus, time_dist$prop_pres, .desc=TRUE)
  
g <- ggplot(time_dist, aes(x = Genus, y = prop_pres)) +
  geom_point()
g
```
Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
